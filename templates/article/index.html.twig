{% extends 'base.html.twig' %}

{% block title %}Administration des Articles{% endblock %}

{% block body %}
    <h1 style="border-bottom: 2px solid #ccc; padding-bottom: 10px;">Gestion des Articles Locaux</h1>

    <p><a href="{{ path('app_article_new') }}" style="text-decoration: none; background-color: #28a745; color: white; padding: 8px 15px; border-radius: 4px;">Créer un nouvel Article</a></p>

    {% if articles is empty %}
        <p style="padding: 20px; border: 1px dashed #ccc;">Aucun article trouvé dans la base de données.</p>
    {% else %}
        <table class="table" style="width: 100%; border-collapse: collapse; margin-top: 20px;">
            <thead>
            <tr style="background-color: #f0f0f0;">
                <th style="padding: 10px; border: 1px solid #ccc;">ID</th>
                <th style="padding: 10px; border: 1px solid #ccc;">Titre</th>
                <th style="padding: 10px; border: 1px solid #ccc;">Auteur</th>
                <th style="padding: 10px; border: 1px solid #ccc;">Publié le</th>
                <th style="padding: 10px; border: 1px solid #ccc;">Slug</th>
                <th style="padding: 10px; border: 1px solid #ccc;">Actions</th>
            </tr>
            </thead>
            <tbody>
            {% for article in articles %}
                <tr>
                    <td style="padding: 10px; border: 1px solid #ccc;">{{ article.id }}</td>
                    <td style="padding: 10px; border: 1px solid #ccc;">{{ article.title }}</td>

                    {# AFFICHAGE DE L'AUTEUR (RELATION) #}
                    <td style="padding: 10px; border: 1px solid #ccc;">{{ article.user.email }}</td>

                    <td style="padding: 10px; border: 1px solid #ccc;">{{ article.createdAt ? article.createdAt|date('Y-m-d H:i') : '' }}</td>
                    <td style="padding: 10px; border: 1px solid #ccc;">{{ article.slug ? article.slug : 'N/A' }}</td>

                    <td style="padding: 10px; border: 1px solid #ccc; white-space: nowrap;">
                        <a href="{{ path('app_article_show', {'id': article.id}) }}">Voir</a> |
                        <a href="{{ path('app_article_edit', {'id': article.id}) }}">Éditer</a> |

                        {# FORMULAIRE DE SUPPRESSION (MÉTHODE DELETE) #}
                        {# Inclut le formulaire généré par Symfony pour le token CSRF et la méthode DELETE #}
                        {% include 'article/_delete_form.html.twig' %}
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% endif %}
{% endblock %}
