{# templates/home/index.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Accueil - Actualités Locales{% endblock %}

{% block body %}
    <h1>Vos Actualités Locales</h1>

    {% if articles is empty %}
        <p>Aucun article n'a été publié pour le moment.
            {# Affiche un lien différent selon que l'utilisateur est connecté ou non #}
            {% if is_granted('ROLE_USER') %}
                <a href="{{ path('app_article_new') }}">Ajoutez-en un !</a>
            {% else %}
                <a href="{{ path('app_login') }}">Connectez-vous</a> pour ajouter des articles.
            {% endif %}
        </p>
    {% else %}
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
            {% for article in articles %}
                <article style="border: 1px solid #ddd; padding: 15px; border-radius: 5px;">
                    <h2>{{ article.title }}</h2>

                    <p>{{ article.content|slice(0, 150) ~ '...' }}</p>

                    {# Accès à l'email de l'auteur via la relation Article->User #}
                    <small>Auteur: **{{ article.user.email }}**</small><br>
                    <small>Publié le: {{ article.createdAt|date('d/m/Y H:i') }}</small>

                    {# Lien vers la page de détails de l'article #}
                    <p><a href="{{ path('app_article_show', {'id': article.id}) }}">Lire la suite →</a></p>
                </article>
            {% endfor %}
        </div>
    {% endif %}
{% endblock %}
